<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API Reference &#8212; ABM Project 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Getting started" href="getting_started.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<section id="module-abm_project">
<span id="package"></span><h2>Package<a class="headerlink" href="#module-abm_project" title="Link to this heading">¶</a></h2>
<p>Agent-based modelling group project (test).</p>
<dl class="py function">
<dt class="sig sig-object py" id="abm_project.configure_mpl">
<span class="sig-prename descclassname"><span class="pre">abm_project.</span></span><span class="sig-name descname"><span class="pre">configure_mpl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#configure_mpl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.configure_mpl" title="Link to this definition">¶</a></dt>
<dd><p>Configure Matplotlib style.</p>
</dd></dl>

</section>
<section id="module-abm_project.kraan">
<span id="kraan-model"></span><h2>Kraan Model<a class="headerlink" href="#module-abm_project.kraan" title="Link to this heading">¶</a></h2>
<p>Implementation of Kraan 2D lattice model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="abm_project.kraan.KraanModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abm_project.kraan.</span></span><span class="sig-name descname"><span class="pre">KraanModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_update_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/kraan.html#KraanModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.kraan.KraanModel" title="Link to this definition">¶</a></dt>
<dd><p>Agent-based decision model for energy transition.</p>
<p>Agents decide to ‘act’ or ‘not act’ at each timestep based on the state of the
environment and the social pressures of their neighbors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="abm_project.kraan.KraanModel.choose">
<span class="sig-name descname"><span class="pre">choose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_active</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/kraan.html#KraanModel.choose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.kraan.KraanModel.choose" title="Link to this definition">¶</a></dt>
<dd><p>Sample a decision for each agent.</p>
<p>After sampling a random number $r in [0,1]$, decisions are taken to
be +1 (action) if $r &lt; p_text{active}$ for a given agent, and -1 (inactive)
otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p_active</strong> – 1D numpy array with length equal to the number of agents,
containing the probability for each agent choosing to act.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D numpy array containing the sampled action for each agent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.kraan.KraanModel.decide">
<span class="sig-name descname"><span class="pre">decide</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/kraan.html#KraanModel.decide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.kraan.KraanModel.decide" title="Link to this definition">¶</a></dt>
<dd><p>Simulate a single decision step for each agent.</p>
<p>Agents’ decisions are probabilistically sampled according to a logistic
model, with representative utility of an action $V_i(a)$ balancing an agents’
current perception of the environment, and their social pressures.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.kraan.KraanModel.draw">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/kraan.html#KraanModel.draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.kraan.KraanModel.draw" title="Link to this definition">¶</a></dt>
<dd><p>Plot the current state of the network and agents’ actions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.kraan.KraanModel.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simmer_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/kraan.html#KraanModel.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.kraan.KraanModel.run" title="Link to this definition">¶</a></dt>
<dd><p>Run model for a number of environmental updates.</p>
<p>Runs the model for a number of steps. Each step comprises two parts:
1. Update the environment,
2. Simulate a number of decision steps, so as to reach equilibrium.</p>
<p>Finally, we yield control to the caller, passing the current timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_steps</strong> – Number of times to update the environment.</p></li>
<li><p><strong>simmer_steps</strong> – Number of decision steps to simulate after each environment
update.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>The current timestep, measured in number of environmental updates (minus 1).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.kraan.KraanModel.simmer">
<span class="sig-name descname"><span class="pre">simmer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/kraan.html#KraanModel.simmer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.kraan.KraanModel.simmer" title="Link to this definition">¶</a></dt>
<dd><p>Simulate a number of decisions for each agent.</p>
<p>This is a convenience method for allowing the model to reach equilibrium
after an environment update.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>steps</strong> – Number of decisions to simulate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abm_project.kraan.KraanModel.u_active">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u_active</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#abm_project.kraan.KraanModel.u_active" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the utility for an agent to be active in the current state.</p>
<p>The environment is defined by</p>
<p>$h = frac{U(text{active}) + U(text{inactive})}{2}$</p>
<p>Since the utility for inaction is fixed, we calculate the utility
for action by rearranging this formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The current (homogeneous) utility for action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.kraan.exogenous_env">
<span class="sig-prename descclassname"><span class="pre">abm_project.kraan.</span></span><span class="sig-name descname"><span class="pre">exogenous_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decrement_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/kraan.html#exogenous_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.kraan.exogenous_env" title="Link to this definition">¶</a></dt>
<dd><p>Construct an exogenous environment update function.</p>
<p>Comprises a sequence of linear increments to the environment, followed by a
sequence of linear decrements, returning to the original value.</p>
<p>Default arguments are as specified in Kraan 2019.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n0</strong> – Initial state of the environment at time $t=0$.</p></li>
<li><p><strong>n_max</strong> – Maximum value of the environment, to be reached after increments.</p></li>
<li><p><strong>increment_steps</strong> – Number of steps to take when increasing environment state to
n_max.</p></li>
<li><p><strong>decrement_steps</strong> – Number of steps to take when decrementing environment state
from n_max to n0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A constructed function to execute the specified update strategy.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-abm_project.oop_model">
<span id="basic-oop-model"></span><h2>Basic OOP Model<a class="headerlink" href="#module-abm_project.oop_model" title="Link to this heading">¶</a></h2>
<p>Agent-based model base class for simulations.</p>
<p>This module defines a base class for agent-based models, providing
a framework for initializing agents, calculating neighbor actions,
and managing the simulation environment.</p>
<dl class="py class">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abm_project.oop_model.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_update_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_attr_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighb_prediction_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peer_pressure_learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_status_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peer_pressure_coeff_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_perception_coeff_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_save_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel" title="Link to this definition">¶</a></dt>
<dd><p>Base model for agent-based simulations.</p>
<p>This class initializes a grid of agents and provides methods
for running the simulation, updating the environment, and
calculating neighbor actions.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.num_agents">
<span class="sig-name descname"><span class="pre">num_agents</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.num_agents" title="Link to this definition">¶</a></dt>
<dd><p>Total number of agents in the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.width">
<span class="sig-name descname"><span class="pre">width</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.width" title="Link to this definition">¶</a></dt>
<dd><p>Width of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.height">
<span class="sig-name descname"><span class="pre">height</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.height" title="Link to this definition">¶</a></dt>
<dd><p>Height of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.radius">
<span class="sig-name descname"><span class="pre">radius</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.radius" title="Link to this definition">¶</a></dt>
<dd><p>Radius for neighbor calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.memory_count">
<span class="sig-name descname"><span class="pre">memory_count</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.memory_count" title="Link to this definition">¶</a></dt>
<dd><p>Number of past actions to remember for each agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.env_update_option">
<span class="sig-name descname"><span class="pre">env_update_option</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.env_update_option" title="Link to this definition">¶</a></dt>
<dd><p>Method to update the environment status.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.adaptive_attr_option">
<span class="sig-name descname"><span class="pre">adaptive_attr_option</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.adaptive_attr_option" title="Link to this definition">¶</a></dt>
<dd><p>Option for adaptive attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.rng" title="Link to this definition">¶</a></dt>
<dd><p>Random number generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.random.Generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.agents">
<span class="sig-name descname"><span class="pre">agents</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.agents" title="Link to this definition">¶</a></dt>
<dd><p>2D array of Agent objects representing the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.agent_action_history">
<span class="sig-name descname"><span class="pre">agent_action_history</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.agent_action_history" title="Link to this definition">¶</a></dt>
<dd><p>History of agent actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.agent_env_status_history">
<span class="sig-name descname"><span class="pre">agent_env_status_history</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.agent_env_status_history" title="Link to this definition">¶</a></dt>
<dd><p>History of environment status.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.agent_peer_pressure_coeff_history">
<span class="sig-name descname"><span class="pre">agent_peer_pressure_coeff_history</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.agent_peer_pressure_coeff_history" title="Link to this definition">¶</a></dt>
<dd><p>History of peer pressure coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.agent_env_utility_history">
<span class="sig-name descname"><span class="pre">agent_env_utility_history</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.agent_env_utility_history" title="Link to this definition">¶</a></dt>
<dd><p>History of environment utilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.time">
<span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#abm_project.oop_model.BaseModel.time" title="Link to this definition">¶</a></dt>
<dd><p>Current time step in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_ADAPTIVE_ATTR_OPTION">
<span class="sig-name descname"><span class="pre">DEFAULT_ADAPTIVE_ATTR_OPTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_ADAPTIVE_ATTR_OPTION" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_ENV_UPDATE_OPTION">
<span class="sig-name descname"><span class="pre">DEFAULT_ENV_UPDATE_OPTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'linear'</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_ENV_UPDATE_OPTION" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_HEIGHT">
<span class="sig-name descname"><span class="pre">DEFAULT_HEIGHT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_HEIGHT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_LEARNING_RATE">
<span class="sig-name descname"><span class="pre">DEFAULT_LEARNING_RATE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_LEARNING_RATE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_MEMORY_COUNT">
<span class="sig-name descname"><span class="pre">DEFAULT_MEMORY_COUNT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_MEMORY_COUNT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_NUM_AGENTS">
<span class="sig-name descname"><span class="pre">DEFAULT_NUM_AGENTS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_NUM_AGENTS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_PREDICTION_OPTION">
<span class="sig-name descname"><span class="pre">DEFAULT_PREDICTION_OPTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'linear'</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_PREDICTION_OPTION" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_RADIUS">
<span class="sig-name descname"><span class="pre">DEFAULT_RADIUS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_RADIUS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_RATIONALITY">
<span class="sig-name descname"><span class="pre">DEFAULT_RATIONALITY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_RATIONALITY" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.DEFAULT_WIDTH">
<span class="sig-name descname"><span class="pre">DEFAULT_WIDTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#abm_project.oop_model.BaseModel.DEFAULT_WIDTH" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.ave_neighb_action">
<span class="sig-name descname"><span class="pre">ave_neighb_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.ave_neighb_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.ave_neighb_action" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the average action of peers based on their recent actions.</p>
<p>This method computes the average action of neighboring agents,
considering the last <cite>memory</cite> actions (from the end). If memory=1,
only the most recent action is used. If memory &gt; 1, the mean of the
last <cite>memory</cite> actions is used for each neighbor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>int</em>) – X-coordinate of the agent.</p></li>
<li><p><strong>y</strong> (<em>int</em>) – Y-coordinate of the agent.</p></li>
<li><p><strong>memory</strong> (<em>int</em>) – Number of most recent actions to consider.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average action of neighbors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.get_agent_attribute_at_time">
<span class="sig-name descname"><span class="pre">get_agent_attribute_at_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.get_agent_attribute_at_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.get_agent_attribute_at_time" title="Link to this definition">¶</a></dt>
<dd><p>Get the values of a specific agent attribute at a given time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribute</strong> (<em>str</em>) – The attribute history to retrieve (e.g., ‘agent_action_history’).</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The time step to retrieve values for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of the attribute values at the specified time.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.get_agent_grid_attribute">
<span class="sig-name descname"><span class="pre">get_agent_grid_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.get_agent_grid_attribute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.get_agent_grid_attribute" title="Link to this definition">¶</a></dt>
<dd><p>Get a 2D grid of a specific agent attribute.</p>
<p>This method retrieves the most recent values of a specified
attribute from all agents in the grid and returns it as a 2D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribute</strong> (<em>str</em>) – The attribute to</p></li>
<li><p><strong>agents</strong> (<em>retrieve from</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of the specified attribute values across the grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.get_neighbor_attribute_values">
<span class="sig-name descname"><span class="pre">get_neighbor_attribute_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.get_neighbor_attribute_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.get_neighbor_attribute_values" title="Link to this definition">¶</a></dt>
<dd><p>Get the values of a specific attribute from neighboring agents.</p>
<p>This method retrieves the most recent values of a specified
attribute from all neighbors of the agent at position (x, y).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>int</em>) – X-coordinate of the agent.</p></li>
<li><p><strong>y</strong> (<em>int</em>) – Y-coordinate of the agent.</p></li>
<li><p><strong>attribute</strong> (<em>str</em>) – The attribute to retrieve from neighbors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of attribute values from neighboring agents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.get_neighbors">
<span class="sig-name descname"><span class="pre">get_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#abm_project.agent.Agent" title="abm_project.agent.Agent"><span class="pre">Agent</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.get_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.get_neighbors" title="Link to this definition">¶</a></dt>
<dd><p>Get the neighbors of an agent at position (x, y).</p>
<p>Neighbors are defined as agents within a Moore
neighborhood depending on the radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>int</em>) – X-coordinate of the agent.</p></li>
<li><p><strong>y</strong> (<em>int</em>) – Y-coordinate of the agent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of neighboring agents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#abm_project.agent.Agent" title="abm_project.agent.Agent">Agent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.pred_neighb_action">
<span class="sig-name descname"><span class="pre">pred_neighb_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.pred_neighb_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.pred_neighb_action" title="Link to this definition">¶</a></dt>
<dd><p>Predict the average action of peers based on their recent actions.</p>
<p>This method predicts the average action of neighboring agents
based on their most recent actions, using linear regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>int</em>) – X-coordinate of the agent.</p></li>
<li><p><strong>y</strong> (<em>int</em>) – Y-coordinate of the agent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted average action of neighbors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.run" title="Link to this definition">¶</a></dt>
<dd><p>Run the model for a specified number of steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>steps</strong> (<em>int</em>) – Number of steps to run the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.save_results">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.save_results" title="Link to this definition">¶</a></dt>
<dd><p>Save the agent history to a file.</p>
<p>This method saves the actions, environment status,
peer pressure coefficients, and environment utilities
of agents to a .npz file for later analysis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.oop_model.BaseModel.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/abm_project/oop_model.html#BaseModel.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.oop_model.BaseModel.step" title="Link to this definition">¶</a></dt>
<dd><p>Perform a single step in the model.</p>
<p>This method updates the environment status and allows
agents to decide their actions in parallel.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-abm_project.agent">
<span id="basic-oop-agent"></span><h2>Basic OOP Agent<a class="headerlink" href="#module-abm_project.agent" title="Link to this heading">¶</a></h2>
<p>Agent class for an agent-based model simulation.</p>
<p>This class represents an agent that interacts with its environment and peers.
It includes methods for decision-making based on peer actions and environmental status.</p>
<dl class="py class">
<dt class="sig sig-object py" id="abm_project.agent.Agent">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abm_project.agent.</span></span><span class="sig-name descname"><span class="pre">Agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_update_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_attr_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peer_pressure_learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_status_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peer_pressure_coeff_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_perception_coeff_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/agent.html#Agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent" title="Link to this definition">¶</a></dt>
<dd><p>Agent class for an agent-based model simulation.</p>
<p>This class represents an agent that interacts
with its environment and peers.
It includes methods for decision-making based on
peer actions and environmental status.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.agent.Agent.ACTIONS">
<span class="sig-name descname"><span class="pre">ACTIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[-1,</span> <span class="pre">1]</span></em><a class="headerlink" href="#abm_project.agent.Agent.ACTIONS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.agent.Agent.DEFAULT_ADAPTIVE_ATTR_OPTION">
<span class="sig-name descname"><span class="pre">DEFAULT_ADAPTIVE_ATTR_OPTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#abm_project.agent.Agent.DEFAULT_ADAPTIVE_ATTR_OPTION" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.agent.Agent.DEFAULT_ENV_UPDATE_OPTION">
<span class="sig-name descname"><span class="pre">DEFAULT_ENV_UPDATE_OPTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'linear'</span></em><a class="headerlink" href="#abm_project.agent.Agent.DEFAULT_ENV_UPDATE_OPTION" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.agent.Agent.DEFAULT_MEMORY_COUNT">
<span class="sig-name descname"><span class="pre">DEFAULT_MEMORY_COUNT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#abm_project.agent.Agent.DEFAULT_MEMORY_COUNT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.agent.Agent.DEFAULT_RATIONALITY">
<span class="sig-name descname"><span class="pre">DEFAULT_RATIONALITY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#abm_project.agent.Agent.DEFAULT_RATIONALITY" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.calculate_action_probabilities">
<span class="sig-name descname"><span class="pre">calculate_action_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ave_peer_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.calculate_action_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.calculate_action_probabilities" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the probability of each possible action.</p>
<p>The probabilities are calculated using a logit softmax
function over the utilities of each action.
The formula is:
P(a_i(t) = a) = exp(V_i(a)) / sum(exp(V_i(a’)) for all a’)
where V_i(a) is the utility of action a for agent i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ave_peer_action</strong> (<em>float</em>) – The average action of peers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of probabilities for each action.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.calculate_action_utility">
<span class="sig-name descname"><span class="pre">calculate_action_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ave_peer_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.calculate_action_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.calculate_action_utility" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the utility of taking a specific action.</p>
<p>The utility is calculated as the perceived severity
of the environment multiplied by the action, minus
the cost of deviating from the average peer action.
The formula is:
V_i(a_i(t)) = a_i(t) * U_i(t) - c * (a_i(t) - A_i(t))^2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<em>int</em>) – The action taken by the agent, either -1 or 1.</p></li>
<li><p><strong>ave_peer_action</strong> (<em>float</em>) – The average action of peers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The utility of the action.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.calculate_deviation_cost">
<span class="sig-name descname"><span class="pre">calculate_deviation_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ave_peer_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.calculate_deviation_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.calculate_deviation_cost" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the cost of deviating from the average peer action.</p>
<p>The cost is calculated as:
c * (a_i(t) - A_i(t))^2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<em>int</em>) – The action taken by the agent, either -1 or 1.</p></li>
<li><p><strong>ave_peer_action</strong> (<em>float</em>) – The average action of peers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cost of deviation from your neighbors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.calculate_perceived_severity">
<span class="sig-name descname"><span class="pre">calculate_perceived_severity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.calculate_perceived_severity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.calculate_perceived_severity" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the perceived severity of the environment.</p>
<p>The perceived severity is a function of the environment
status and the agent’s perception coefficient.
It is calculated as:
env_perception_coeff * env_status * -1
The negative sign indicates that a higher environment status
leads to a lower perceived severity.
The perceived severity is used to determine the utility of actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The perceived severity of the environment.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.decide_action">
<span class="sig-name descname"><span class="pre">decide_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ave_peer_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_peer_actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.decide_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.decide_action" title="Link to this definition">¶</a></dt>
<dd><p>Decide on a new action based on peer actions and environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.update_env_perception_coeff">
<span class="sig-name descname"><span class="pre">update_env_perception_coeff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.update_env_perception_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.update_env_perception_coeff" title="Link to this definition">¶</a></dt>
<dd><p>Update the agent’s environment perception coefficient.</p>
<p>This coefficient is used to calculate the cost
of deviating from the agent’s perception of the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.update_environment_status">
<span class="sig-name descname"><span class="pre">update_environment_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_decision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.update_environment_status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.update_environment_status" title="Link to this definition">¶</a></dt>
<dd><p>Update the environment status based on the agent’s action.</p>
<p>The environment status is updated based on the agent’s action
and the current environment status. The update is done using
a sigmoid function, exponential decay, or linear update,
depending on the <cite>env_update_option</cite> specified during initialization.
The formula for the update is:
env_status(t+1) = env_status(t) + delta
where delta is calculated based on the action decision
and the current environment status.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Sigmoid: Rate of change is higher when the environment status is around 0.5.</dt><dd><p>Lowest delta is at 1, highest delta is at 0.0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Sigmoid Asymmetric: Delta is asymmetric based on the action decision.</dt><dd><p>Positive delta is lower when the environment status is low,
and negative delta is higher when the environment status is low.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Exponential: Rate of change decreases as the environment status increases.</dt><dd><p>Lowest delta is at 1, highest delta is at 0.0.</p>
</dd>
</dl>
</li>
<li><p>Linear: Delta is a constant value based on the action decision.</p></li>
<li><p>Bell: Lowest delta at 0 and 1, highest delta at 0.5.</p></li>
<li><dl class="simple">
<dt>Bimodal: Highest delta at two peaks, around 0.25 and 0.75,</dt><dd><p>and lowest delta at 0, 0.5, and 1.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action_decision</strong> (<em>int</em>) – The action taken by the agent, either -1 or 1.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the <cite>env_update_option</cite> is invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.update_past_actions">
<span class="sig-name descname"><span class="pre">update_past_actions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.update_past_actions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.update_past_actions" title="Link to this definition">¶</a></dt>
<dd><p>Update the memory of past actions.</p>
<p>This method maintains a fixed-length memory of past actions.
If the memory exceeds the specified count, the oldest action is removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.agent.Agent.update_peer_pressure_coeff">
<span class="sig-name descname"><span class="pre">update_peer_pressure_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_peer_actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/agent.html#Agent.update_peer_pressure_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.agent.Agent.update_peer_pressure_coeff" title="Link to this definition">¶</a></dt>
<dd><p>Update the agent’s peer pressure coefficient.</p>
<p>This coefficient is used to calculate the cost
of deviating from the average peer action.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-abm_project.vectorised_model">
<span id="vectorised-model"></span><h2>Vectorised Model<a class="headerlink" href="#module-abm_project.vectorised_model" title="Link to this heading">¶</a></h2>
<p>Vectorised implementation of the OOP model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abm_project.vectorised_model.</span></span><span class="sig-name descname"><span class="pre">VectorisedModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_agents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_update_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EnvUpdateFn</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moore</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simmer_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighb_prediction_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">severity_benefit_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'adaptive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_pessimistic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pessimism_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel" title="Link to this definition">¶</a></dt>
<dd><p>Vectorised base model for agent-based simulations.</p>
<p>This model comprises a 2D lattice of agents who repeatedly choose between
cooperation (pro-environmental behaviour) and defection, based on the state
of their local environment and the social norms imposed by their direct
neighbors.</p>
<p>Agents have heterogeneous attributes which weight the respective contributions
of environmental concern and social norms in the decision-making process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.action">
<span class="sig-name descname"><span class="pre">action</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.action" title="Link to this definition">¶</a></dt>
<dd><p>2D array of agents’ actions with shape (time, agent).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.int64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.environment">
<span class="sig-name descname"><span class="pre">environment</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.environment" title="Link to this definition">¶</a></dt>
<dd><p>2D array of agents’ environments with shape (time, agent).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.int64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.s">
<span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.s" title="Link to this definition">¶</a></dt>
<dd><p>2D array of agents’ support for cooperation with shape (time, agent).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.b">
<span class="sig-name descname"><span class="pre">b</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.b" title="Link to this definition">¶</a></dt>
<dd><p>2D array of agents’ decision-making weights, shape (attributes, agent).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.rationality">
<span class="sig-name descname"><span class="pre">rationality</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.rationality" title="Link to this definition">¶</a></dt>
<dd><p>float
Homogeneous rationality coefficient for all agents.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.adj">
<span class="sig-name descname"><span class="pre">adj</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.adj" title="Link to this definition">¶</a></dt>
<dd><p>Normalised adjacency matrix with shape (agent, agent).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.time">
<span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.time" title="Link to this definition">¶</a></dt>
<dd><p>Current time step in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.num_agents">
<span class="sig-name descname"><span class="pre">num_agents</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.num_agents" title="Link to this definition">¶</a></dt>
<dd><p>Total number of agents in the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.width">
<span class="sig-name descname"><span class="pre">width</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.width" title="Link to this definition">¶</a></dt>
<dd><p>Width of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.height">
<span class="sig-name descname"><span class="pre">height</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.height" title="Link to this definition">¶</a></dt>
<dd><p>Height of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.simmer_time">
<span class="sig-name descname"><span class="pre">simmer_time</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.simmer_time" title="Link to this definition">¶</a></dt>
<dd><p>Number of agent adaptation steps between environment updates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.rng" title="Link to this definition">¶</a></dt>
<dd><p>Random number generator for stochastic processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.random.Generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.action_probabilities">
<span class="sig-name descname"><span class="pre">action_probabilities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.action_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.action_probabilities" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the probability of each possible action.</p>
<p>The probabilities are calculated using a logit softmax
function over the utilities of each action.
The formula is:</p>
<div class="math notranslate nohighlight">
\[P(a_i(t) = a) = \frac{\exp(\lambda \cdot V_i(a))}{\exp(\lambda \cdot \
V_i(C)) + \exp(\lambda \cdot V_i(D))}\]</div>
<p>Where <span class="math notranslate nohighlight">\(V_i(a)\)</span> is the representative utility for action <span class="math notranslate nohighlight">\(a\)</span>
for agent <span class="math notranslate nohighlight">\(i\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An array of probabilities for each action, with shape (2,agent).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.adapt">
<span class="sig-name descname"><span class="pre">adapt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.adapt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.adapt" title="Link to this definition">¶</a></dt>
<dd><p>Update agents’ support for cooperation.</p>
<p>Agents’ support for cooperation changes as a function of the current
environment. It decreases when the environment is either particularly
healthy (no reason to act) or particularly unhealthy (no point in acting).
It increases when the environment is not at either of these extremes.</p>
<p>We write the change in support as a derivative:</p>
<div class="math notranslate nohighlight">
\[\frac{ds_i}{dt} = \alpha_i \sigma(n_i) (1 - s_i(t)) \
- \beta_i (1 - \sigma(n_i)) s_i(t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma(n_i) = 4n_i (1 - n_i)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – Current state of the environment, with shape (agent,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.calculate_individual_preference">
<span class="sig-name descname"><span class="pre">calculate_individual_preference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.calculate_individual_preference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.calculate_individual_preference" title="Link to this definition">¶</a></dt>
<dd><p>Calculate agents’ individual preference for an action.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.calculate_social_pressure">
<span class="sig-name descname"><span class="pre">calculate_social_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.calculate_social_pressure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.calculate_social_pressure" title="Link to this definition">¶</a></dt>
<dd><p>Calculate agents’ social pressure when taking a given action.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.decide">
<span class="sig-name descname"><span class="pre">decide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.decide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.decide" title="Link to this definition">¶</a></dt>
<dd><p>Select a new action for each agent.</p>
<p>The probability of selecting each action is set by an agents’ logit model,
based on their current environment and the social norms imposed by their
neighbors.</p>
<p>To select a new action, we sample a random number in [0,1] for each agent.
If it does not exceed the probability of cooperation, the agent cooperates,
and defects otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> – Simmer step idx</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.initialise">
<span class="sig-name descname"><span class="pre">initialise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zero</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.initialise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.initialise" title="Link to this definition">¶</a></dt>
<dd><p>Initialise agents’ and environment state.</p>
<p>Optionally sets agents’ initial actions to zero (defection), and
environments to one (healthy).</p>
<p>After initialising the environment, runs agent adaptation for 100
steps to reach stable support levels (for cooperation) given agent
heterogeneity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>zero</strong> – Initialise environment as healthy and agents as cooperating.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.mean_local_action">
<span class="sig-name descname"><span class="pre">mean_local_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.mean_local_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.mean_local_action" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the average action in each agents’ local neighborhood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>memory</strong> – Number of previous neighbors’ actions to consider.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean local action for each agent, reflecting the perceived social norm
for each agent at the current timestep. Shape is (agent,).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.pred_neighb_action">
<span class="sig-name descname"><span class="pre">pred_neighb_action</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.pred_neighb_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.pred_neighb_action" title="Link to this definition">¶</a></dt>
<dd><p>Predict the average action of peers based on their recent actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>memory</strong> (<em>int</em>) – Number of previous steps to use for prediction.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Prediction method, “linear” or “logistic”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted average action of
neighbors for each agent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.representative_utility">
<span class="sig-name descname"><span class="pre">representative_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.representative_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.representative_utility" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the representative utility of an action for each agent.</p>
<p>Representative utility is a linear combination of the support for
cooperation and the social norms imposed by an agents’ neighbors:</p>
<div class="math notranslate nohighlight">
\[V_i(a) = b_1 \cdot [a^* \cdot s_i(t) + (1 - a^*) \cdot (1 - s_i(t))] + \
b_2 (a^* - \overline{A^*}_i (t))^2\]</div>
<p>Where <span class="math notranslate nohighlight">\(a^* = (a + 1)/2\)</span> is a transformation of the action to the set
<span class="math notranslate nohighlight">\(\{0,1\}\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.reset" title="Link to this definition">¶</a></dt>
<dd><p>Re-initialise agents to original actions and environment states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.run" title="Link to this definition">¶</a></dt>
<dd><p>Run simulation for specified number of steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>steps</strong> – Number of steps to iterate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.simmer">
<span class="sig-name descname"><span class="pre">simmer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.simmer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.simmer" title="Link to this definition">¶</a></dt>
<dd><p>Simulate a number of agent decision-making and adaptation steps.</p>
<p>A step comprises the following processes:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Agents choose an action based on their current support for cooperation,</dt><dd><p>and the social norms imposed by their neighbors.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Agents adapt their support for cooperation based on the current state</dt><dd><p>of the environment.</p>
</dd>
</dl>
</li>
</ol>
<p>Note that the environment is fixed during this process. As such, a longer
simmer time reflects a faster rate of behavioural change relative to the
rate of environmental change.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.step" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single simulation step.</p>
<p>A step comprises the following processes:
1. Increment the simulation time.
2. Update the environment based on agents’ actions in the previous timestep.
3. Run a fixed number of agent decision-making and adaptation steps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.vectorised_model.VectorisedModel.update_env">
<span class="sig-name descname"><span class="pre">update_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/vectorised_model.html#VectorisedModel.update_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.vectorised_model.VectorisedModel.update_env" title="Link to this definition">¶</a></dt>
<dd><p>Update each agents’ environment based on their last action.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-abm_project.mean_field">
<span id="mean-field"></span><h2>Mean-field<a class="headerlink" href="#module-abm_project.mean_field" title="Link to this heading">¶</a></h2>
<p>Mean-field model calculations and simulation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="abm_project.mean_field.FixedpointResult">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">FixedpointResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">middle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/mean_field.html#FixedpointResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.FixedpointResult" title="Link to this definition">¶</a></dt>
<dd><p>Solutions to a mean-action fixed point problem.</p>
<dl class="py method">
<dt class="sig sig-object py" id="abm_project.mean_field.FixedpointResult.roots">
<span class="sig-name descname"><span class="pre">roots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/mean_field.html#FixedpointResult.roots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.FixedpointResult.roots" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the fixed points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of floats representing each fixed point, both stable and unstable,
in increasing value order.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.mean_field.FixedpointResult.stable">
<span class="sig-name descname"><span class="pre">stable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/mean_field.html#FixedpointResult.stable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.FixedpointResult.stable" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the stable fixed points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of floats representing each stable fixed point.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.mean_field.FixedpointResult.unstable">
<span class="sig-name descname"><span class="pre">unstable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/mean_field.html#FixedpointResult.unstable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.FixedpointResult.unstable" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the unstable fixed points. May be empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A (possibly empty) list of floats representing each unstable fixed point.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.mean_field.compute_s_from_p">
<span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">compute_s_from_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/mean_field.html#compute_s_from_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.compute_s_from_p" title="Link to this definition">¶</a></dt>
<dd><p>Calculate mean preference for cooperation given mean P(C).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.mean_field.f_dm_dt">
<span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">f_dm_dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/mean_field.html#f_dm_dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.f_dm_dt" title="Link to this definition">¶</a></dt>
<dd><p>Construct parameterised mean-field dm/dt derivative function.</p>
<p>Calculates rate of change in the average action, given the current average state
of the environment, and average action in a mean-field model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rationality</strong> – Controls how rational agents are. Larger is more rational
(deterministic). 0 is random.</p></li>
<li><p><strong>b</strong> – Utility function weight for the ‘individual action preference’ term.</p></li>
<li><p><strong>c</strong> – Utility function weight for the ‘peer pressure’ term.</p></li>
<li><p><strong>alpha</strong> – How quickly agents increase support for climate mitigation when the
environment is non-extreme.</p></li>
<li><p><strong>beta</strong> – How quickly agents decrease support for climate mitigation when the
environment is particularly good (no reason to act) or particularly
bad (action is meaningless).</p></li>
<li><p><strong>rate</strong> – Scale coefficient for the derivative, controls the general rate
of change in preference for cooperation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.mean_field.f_dn_dt">
<span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">f_dn_dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recovery</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/mean_field.html#f_dn_dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.f_dn_dt" title="Link to this definition">¶</a></dt>
<dd><p>Construct parameterised mean-field dn/dt derivative function.</p>
<p>Calculates rate of change in the mean environmental state, given the
expected probability of cooperation in a mean-field model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>recovery</strong> – How quickly the environment recovers under positive action.</p></li>
<li><p><strong>pollution</strong> – How quickly the environment degrades due to negative action.</p></li>
<li><p><strong>rate</strong> – Scale coefficient for the derivative, controls the general rate
of change in the environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.mean_field.f_ds_dt">
<span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">f_ds_dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/mean_field.html#f_ds_dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.f_ds_dt" title="Link to this definition">¶</a></dt>
<dd><p>Construct parameterised mean-field ds/dt derivative function.</p>
<p>Calculates rate of change in the average preference for cooperation, given
the current average state of the average environment in a mean-field model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> – How quickly agents increase support for climate mitigation when the
environment is non-extreme.</p></li>
<li><p><strong>beta</strong> – How quickly agents decrease support for climate mitigation when the
environment is particularly good (no reason to act) or particularly
bad (action is meaningless).</p></li>
<li><p><strong>rate</strong> – Scale coefficient for the derivative, controls the general rate
of change in preference for cooperation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.mean_field.fixedpoint_mean_action">
<span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">fixedpoint_mean_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_warnings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#abm_project.mean_field.FixedpointResult" title="abm_project.mean_field.FixedpointResult"><span class="pre">FixedpointResult</span></a></span></span><a class="reference internal" href="_modules/abm_project/mean_field.html#fixedpoint_mean_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.fixedpoint_mean_action" title="Link to this definition">¶</a></dt>
<dd><p>Find all possible mean-action values, given mean preference for cooperation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> – Average preference for climate mitigation in the mean-field model.</p></li>
<li><p><strong>c</strong> – Utility function weight for the ‘peer pressure’ term.</p></li>
<li><p><strong>rationality</strong> – Controls how rational agents are. Larger is more rational
(deterministic). 0 is random.</p></li>
<li><p><strong>ignore_warnings</strong> – Don’t print warning messages when fixed-point solver doesn’t
converge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A FixedPointResult object containing all possible values which the mean action
can take.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.mean_field.solve">
<span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recovery</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_update_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_update_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/mean_field.html#solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.solve" title="Link to this definition">¶</a></dt>
<dd><p>Simulate a mean-field model run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – Utility function weight for the ‘individual action preference’ term.</p></li>
<li><p><strong>c</strong> – Utility function weight for the ‘peer pressure’ term.</p></li>
<li><p><strong>alpha</strong> – How quickly agents increase support for climate mitigation when the
environment is non-extreme.</p></li>
<li><p><strong>beta</strong> – How quickly agents decrease support for climate mitigation when the
environment is particularly good (no reason to act) or particularly
bad (action is meaningless).</p></li>
<li><p><strong>pollution</strong> – How quickly the environment degrades due to negative action.</p></li>
<li><p><strong>recovery</strong> – How quickly the environment recovers under positive action.</p></li>
<li><p><strong>n_update_rate</strong> – Scale coefficient for dn/dt, controls the general rate
of change in the (average) environment.</p></li>
<li><p><strong>s_update_rate</strong> – Scale coefficient for ds/dt, controls the general rate
of change in preference for cooperation.</p></li>
<li><p><strong>n0</strong> – Initial average environmental state.</p></li>
<li><p><strong>m0</strong> – Initial average action.</p></li>
<li><p><strong>num_steps</strong> – Number of time-steps to simulate.</p></li>
<li><p><strong>rationality</strong> – Controls how rational agents are. Larger is more rational
(deterministic). 0 is random.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (t, results), where t is a vector of real-values time points at
which the model state is measured, and results is a tuple (n, s, sp, m, p),
where: n is the mean environment state, s is the mean preference for climate
mitigation, sp is the mean social pressure experienced at each timestep, m
is the mean action, and p is the probability of choosing climate mitigation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.mean_field.solve_for_equilibria">
<span class="sig-prename descclassname"><span class="pre">abm_project.mean_field.</span></span><span class="sig-name descname"><span class="pre">solve_for_equilibria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recovery</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/mean_field.html#solve_for_equilibria"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.mean_field.solve_for_equilibria" title="Link to this definition">¶</a></dt>
<dd><p>Identify mean-field equilibrium points for a model.</p>
<p>Equilibria are characterised by the state of the environment, and the mean action.
A point (n,m) is an equilibria if dn/dt = dm/dt = 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – Utility function weight for the ‘individual action preference’ term.</p></li>
<li><p><strong>c</strong> – Utility function weight for the ‘peer pressure’ term.</p></li>
<li><p><strong>rationality</strong> – Controls how rational agents are. Larger is more rational
(deterministic). 0 is random.</p></li>
<li><p><strong>alpha</strong> – How quickly agents increase support for climate mitigation when the
environment is non-extreme.</p></li>
<li><p><strong>beta</strong> – How quickly agents decrease support for climate mitigation when the
environment is particularly good (no reason to act) or particularly
bad (action is meaningless).</p></li>
<li><p><strong>recovery</strong> – How quickly the environment recovers under positive action.</p></li>
<li><p><strong>pollution</strong> – How quickly the environment degrades due to negative action.</p></li>
<li><p><strong>rate</strong> – Scale coefficient for the derivative, controls the general rate
of change in preference for cooperation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (N, M) containing pairs of equilibria points
(environment state, action).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-abm_project.metrics">
<span id="metrics"></span><h2>Metrics<a class="headerlink" href="#module-abm_project.metrics" title="Link to this heading">¶</a></h2>
<p>Functions to measure model observables.</p>
<dl class="py function">
<dt class="sig sig-object py" id="abm_project.metrics.pluralistic_ignorance">
<span class="sig-prename descclassname"><span class="pre">abm_project.metrics.</span></span><span class="sig-name descname"><span class="pre">pluralistic_ignorance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#abm_project.vectorised_model.VectorisedModel" title="abm_project.vectorised_model.VectorisedModel"><span class="pre">VectorisedModel</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/metrics.html#pluralistic_ignorance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.metrics.pluralistic_ignorance" title="Link to this definition">¶</a></dt>
<dd><p>Measure agents’ pluralistic ignorance at the end of simulation.</p>
<p>Pluralistic ignorance is a phenomenon which occurs when individuals underestimate
public support for a particular action, leading them to behave in a manner which
does not reflect their own beliefs, even when true public support is high.</p>
<p>To measure an agent’s pluralistic ignorance at the end of simulation, we consider
their expected actions:</p>
<ol class="arabic simple">
<li><p>Under perceived social norms, <span class="math notranslate nohighlight">\(\mathbb{E}[a_i]_\text{perceived}\)</span></p></li>
<li><p>In absence of social norms, <span class="math notranslate nohighlight">\(\mathbb{E}[a_i]_\text{individual}\)</span></p></li>
<li><dl class="simple">
<dt>When observing their neighbors’ true preferences,</dt><dd><p><span class="math notranslate nohighlight">\(\mathbb{E}[a_i]_\text{true}\)</span></p>
</dd>
</dl>
</li>
</ol>
<p>An agent <span class="math notranslate nohighlight">\(i\)</span>’s pluralistic ignorance is calculated as:</p>
<div class="math notranslate nohighlight">
\[\psi_i = \max\{0, \
|\mathbb{E}[a_i]_\text{perceived} - \mathbb{E}[a_i]_\text{individual}| - \
|\mathbb{E}[a_i]_\text{true} - \mathbb{E}[a_i]_\text{individual}|\}\]</div>
<p>i.e., it is large when knowing the true social norm would allow an agent to behave
in a manner more consistent with their individual preferences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> – A VectorisedModel which has been run for at least k timesteps.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D Numpy array containing the measured pluralistic ignorance for each agent.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="plotting-tools">
<h2>Plotting Tools<a class="headerlink" href="#plotting-tools" title="Link to this heading">¶</a></h2>
<p id="module-abm_project.plotting">Plotting functions for agent-based model visualizations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.animate_grid_states">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">animate_grid_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#animate_grid_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.animate_grid_states" title="Link to this definition">¶</a></dt>
<dd><p>Animate the grid states over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_history</strong> (<em>np.ndarray</em>) – 3D array of shape (num_steps, height, width)</p></li>
<li><p><strong>colormap</strong> (<em>str</em><em> or </em><em>Colormap</em>) – Colormap for the grid visualization.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of the plot.</p></li>
<li><p><strong>colorbar_label</strong> (<em>str</em>) – Label for the colorbar.</p></li>
<li><p><strong>file_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the file to save the animation.
If None, will display the plot.</p></li>
<li><p><strong>clim</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple (vmin, vmax) to set colorbar limits.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The animation object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ani (FuncAnimation)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.configure_mpl">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">configure_mpl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#configure_mpl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.configure_mpl" title="Link to this definition">¶</a></dt>
<dd><p>Configure Matplotlib style.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.get_data_directory">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">get_data_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#get_data_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.get_data_directory" title="Link to this definition">¶</a></dt>
<dd><p>Get the directory for saving data files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the file to save the data. If None
will return the directory without a file name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Directory path for saving data files.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.get_file_basename">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">get_file_basename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">severity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#get_file_basename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.get_file_basename" title="Link to this definition">¶</a></dt>
<dd><p>Generate a standardized file basename based on parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>suffix</strong> (<em>str</em>) – Suffix for the file name.</p></li>
<li><p><strong>neighb</strong> (<em>str</em>) – Neighborhood type (e.g., “linear”, “von_neumann”).</p></li>
<li><p><strong>severity</strong> (<em>str</em>) – Severity level (e.g., “low”, “medium”, “high”).</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – Radius of the neighborhood.</p></li>
<li><p><strong>b2</strong> (<em>float</em><em> | </em><em>None</em>) – Second utility function weight, or None if not applicable.</p></li>
<li><p><strong>env</strong> (<em>str</em>) – Environment update type (e.g., “static”, “dynamic”).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A standardized file basename.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.get_plot_directory">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">get_plot_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#get_plot_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.get_plot_directory" title="Link to this definition">¶</a></dt>
<dd><p>Get the directory for saving plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the file to save the plot. If None
will return the directory without a file name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Directory path for saving plots.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.plot_current_grid_state">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_current_grid_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#plot_current_grid_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.plot_current_grid_state" title="Link to this definition">¶</a></dt>
<dd><p>Plot the current state of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<em>np.ndarray</em>) – 2D array representing the grid state.</p></li>
<li><p><strong>colormap</strong> (<em>str</em><em> or </em><em>Colormap</em>) – Colormap for the grid visualization.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of the plot.</p></li>
<li><p><strong>colorbar_label</strong> (<em>str</em>) – Label for the colorbar.</p></li>
<li><p><strong>file_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the file to save the plot. If None
will display the plot.</p></li>
<li><p><strong>clim</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple (vmin, vmax) to set colorbar limits.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.plot_grid_average_over_time">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_grid_average_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#plot_grid_average_over_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.plot_grid_average_over_time" title="Link to this definition">¶</a></dt>
<dd><p>Plot overall agent values over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_values</strong> (<em>np.ndarray</em>) – 3D array of shape (num_steps, height,
width) representing the values to average over time.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of the plot.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>) – Label for the x-axis.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – Label for the y-axis.</p></li>
<li><p><strong>file_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the file to save the plot. If None,
will display the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.plot_list_over_time">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_list_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#plot_list_over_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.plot_list_over_time" title="Link to this definition">¶</a></dt>
<dd><p>Plot a list of data over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em><em>[</em><em>np.ndarray</em><em>]</em>) – List of 1D arrays to plot.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of the plot.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>) – Label for the x-axis.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – Label for the y-axis.</p></li>
<li><p><strong>file_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the file to save the plot. If None,
will display the plot.</p></li>
<li><p><strong>legend_labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Labels for each line in the legend.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.plot_mean_and_variability_array">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_mean_and_variability_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'std'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#plot_mean_and_variability_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.plot_mean_and_variability_array" title="Link to this definition">¶</a></dt>
<dd><p>Plot the mean and variability of a 2D array over time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.plot_phase_portrait">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_phase_portrait</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recovery</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equilibria</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_dt_nullcline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_dt_nullcline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critical_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#plot_phase_portrait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.plot_phase_portrait" title="Link to this definition">¶</a></dt>
<dd><p>Draw a phase portrait for a mean-field model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> – Utility function weight for the ‘peer pressure’ term.</p></li>
<li><p><strong>recovery</strong> – How quickly the environment recovers under positive action.</p></li>
<li><p><strong>pollution</strong> – How quickly the environment degrades due to negative action.</p></li>
<li><p><strong>rationality</strong> – Controls how rational agents are. Larger is more rational
(deterministic). 0 is random.</p></li>
<li><p><strong>gamma_n</strong> – Scale coefficient for dn/dt, controls the general rate
of change in the (average) environment.</p></li>
<li><p><strong>gamma_s</strong> – Scale coefficient for ds/dt, controls the general rate
of change in preference for cooperation.</p></li>
<li><p><strong>equilibria</strong> – Display equilibria as red circles.</p></li>
<li><p><strong>dn_dt_nullcline</strong> – Show dn/dt = 0 as a dashed grey line.</p></li>
<li><p><strong>dm_dt_nullcline</strong> – Show dm/dt = 0 as orange (stable) and green (unstable)
circles.</p></li>
<li><p><strong>critical_points</strong> – Show critical points where ds/dt diverges (currently
unimplemented).</p></li>
<li><p><strong>ax</strong> – Optional matplotlib Axes object to draw plot onto. If unspecified, uses
the current artist.</p></li>
<li><p><strong>b</strong> – Optional utility function weight for the ‘individual preference’ term.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.plot_sobol_indices">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_sobol_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Si</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#plot_sobol_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.plot_sobol_indices" title="Link to this definition">¶</a></dt>
<dd><p>Plot Sobol sensitivity indices for given time steps and variable names.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.plot_support_derivative">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_support_derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#plot_support_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.plot_support_derivative" title="Link to this definition">¶</a></dt>
<dd><p>Plot the derivative of support for cooperation with respect to environment.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.plotting.save_and_plot_heatmap">
<span class="sig-prename descclassname"><span class="pre">abm_project.plotting.</span></span><span class="sig-name descname"><span class="pre">save_and_plot_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">severity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_update_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationality_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_s_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/plotting.html#save_and_plot_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.plotting.save_and_plot_heatmap" title="Link to this definition">¶</a></dt>
<dd><p>Save and plot a heatmap of the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 2D array of data to plot.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title for the heatmap.</p></li>
<li><p><strong>suffix</strong> (<em>str</em>) – Suffix for the file name.</p></li>
<li><p><strong>neighb</strong> (<em>str</em>) – Neighborhood type (e.g., “linear”, “von_neumann”).</p></li>
<li><p><strong>severity</strong> (<em>str</em>) – Severity level (e.g., “low”, “medium”, “high”).</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – Radius of the neighborhood.</p></li>
<li><p><strong>b2</strong> (<em>float</em><em> | </em><em>None</em>) – Second utility function weight,
or None if not applicable.</p></li>
<li><p><strong>env_update_type</strong> (<em>str</em>) – Environment update type (e.g., “static”, “dynamic”).</p></li>
<li><p><strong>savedir</strong> (<em>Path</em>) – Directory to save the heatmap and data.</p></li>
<li><p><strong>rationality_values</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>None</em>) – List of rationality
values for x-axis ticks.</p></li>
<li><p><strong>gamma_s_values</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>None</em>) – List of support
update rates for y-axis ticks.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Link to this heading">¶</a></h2>
<p id="module-abm_project.utils">Utility functions for agent-based models.</p>
<dl class="py function">
<dt class="sig sig-object py" id="abm_project.utils.exponential_update">
<span class="sig-prename descclassname"><span class="pre">abm_project.utils.</span></span><span class="sig-name descname"><span class="pre">exponential_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/utils.html#exponential_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.utils.exponential_update" title="Link to this definition">¶</a></dt>
<dd><p>Construct exponential environment update function.</p>
<div class="math notranslate nohighlight">
\[n(t+1) = n(t) + a\cdot r \cdot \exp(-n(t))\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rate</strong> – Multiplicative coefficient for exponential function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Exponential update function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.utils.lattice2d">
<span class="sig-prename descclassname"><span class="pre">abm_project.utils.</span></span><span class="sig-name descname"><span class="pre">lattice2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/utils.html#lattice2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.utils.lattice2d" title="Link to this definition">¶</a></dt>
<dd><p>Construct normalised adjacency matrix for a 2D lattice.</p>
<p>Uses networkx to create a 2D lattice with optional periodic boundaries and
Moore neighborhoods (diagonals). Converts this to a sparse adjacency matrix
with normalised rows, to simplify computing averages over neighborhoods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> – Number of nodes along the horizontal span of the lattice.</p></li>
<li><p><strong>height</strong> – Number of nodes along the vertical span of the lattice.</p></li>
<li><p><strong>periodic</strong> – Connect nodes at the edges of the lattice with periodic boundary
conditions.</p></li>
<li><p><strong>diagonals</strong> – Connect nodes to their diagonal neighbors, also known as the Moore
neighborhood. Default is the von Neumann neighborhood (cartesian neighbors).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sparse CSR adjacency matrix with shape (width x height, width x height),
normalised per row.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.utils.linear_update">
<span class="sig-prename descclassname"><span class="pre">abm_project.utils.</span></span><span class="sig-name descname"><span class="pre">linear_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/utils.html#linear_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.utils.linear_update" title="Link to this definition">¶</a></dt>
<dd><p>Construct linear environment update function.</p>
<div class="math notranslate nohighlight">
\[n(t+1) = n(t) + a\cdot r\]</div>
<p>The returned value is clipped to the interval [0,1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rate</strong> – Linear step size.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Linear update function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.utils.piecewise_exponential_update">
<span class="sig-prename descclassname"><span class="pre">abm_project.utils.</span></span><span class="sig-name descname"><span class="pre">piecewise_exponential_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recovery</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/utils.html#piecewise_exponential_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.utils.piecewise_exponential_update" title="Link to this definition">¶</a></dt>
<dd><p>Construct piecewise exponential environment update function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>recovery</strong> – Rate of improvement due to good actions</p></li>
<li><p><strong>pollution</strong> – Rate of degradation due to bad actions</p></li>
<li><p><strong>gamma</strong> – Step size for environmental change</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Piecewise exponential update function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.utils.sigmoid">
<span class="sig-prename descclassname"><span class="pre">abm_project.utils.</span></span><span class="sig-name descname"><span class="pre">sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/utils.html#sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.utils.sigmoid" title="Link to this definition">¶</a></dt>
<dd><p>Sigmoid function for logistic regression.</p>
<p>This function defines a sigmoid curve for logistic regression
fitting, which maps any real-valued number into the range [0, 1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>np.ndarray</em>) – Input value(s) to the sigmoid function.</p></li>
<li><p><strong>a</strong> (<em>float</em>) – Slope of the sigmoid curve.</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Offset of the sigmoid curve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sigmoid-transformed value(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.utils.sigmoid_update">
<span class="sig-prename descclassname"><span class="pre">abm_project.utils.</span></span><span class="sig-name descname"><span class="pre">sigmoid_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/utils.html#sigmoid_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.utils.sigmoid_update" title="Link to this definition">¶</a></dt>
<dd><p>Update environment according to sigmoid rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – Each agents’ current environment, shape: (agents,)</p></li>
<li><p><strong>a</strong> – Each agents’ current action, shape: (agents,)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy array of new environment values for each agent, with same shape as <cite>n</cite>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-abm_project.batch_run_tools">
<span id="batch-run-tools"></span><h2>Batch Run Tools<a class="headerlink" href="#module-abm_project.batch_run_tools" title="Link to this heading">¶</a></h2>
<p>Batch run tools for ABM project.</p>
<dl class="py class">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.UnionFind">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">UnionFind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#UnionFind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.UnionFind" title="Link to this definition">¶</a></dt>
<dd><p>Union-Find data structure for efficient connectivity checks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.UnionFind.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#UnionFind.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.UnionFind.find" title="Link to this definition">¶</a></dt>
<dd><p>Find the root of the component containing x with path compression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.UnionFind.union">
<span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#UnionFind.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.UnionFind.union" title="Link to this definition">¶</a></dt>
<dd><p>Union the components containing x and y.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.analyze_environment_clusters_periodic">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">analyze_environment_clusters_periodic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#analyze_environment_clusters_periodic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.analyze_environment_clusters_periodic" title="Link to this definition">¶</a></dt>
<dd><p>Analyze clusters in a 2D environment with periodic boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>environment</strong> – 1D array of environment values per agent.</p></li>
<li><p><strong>width</strong> – Grid width.</p></li>
<li><p><strong>height</strong> – Grid height.</p></li>
<li><p><strong>threshold</strong> – Threshold to binarize the environment (default = 0.5)</p></li>
<li><p><strong>diagonal</strong> – If True, use 8-connectivity (diagonal neighbors included).
If False, use 4-connectivity (adjacent only).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of clusters found
cluster_sizes: List of sizes of each cluster
labels: 2D array of labeled clusters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>num_clusters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.attribute_variance_over_time">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">attribute_variance_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#attribute_variance_over_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.attribute_variance_over_time" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the mean variance of a given attribute over time across all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models</strong> (<em>list</em><em>[</em><a class="reference internal" href="#abm_project.oop_model.BaseModel" title="abm_project.oop_model.BaseModel"><em>BaseModel</em></a><em>]</em>) – List of BaseModel instances.</p></li>
<li><p><strong>attr</strong> (<em>str</em>) – Attribute name to compute variance over
(e.g., ‘agent_peer_pressure_coeff_history’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mean variance at each time step.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.average_metric_over_time">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">average_metric_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#average_metric_over_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.average_metric_over_time" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the average of a given attribute over time across all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models</strong> (<em>list</em><em>[</em><a class="reference internal" href="#abm_project.oop_model.BaseModel" title="abm_project.oop_model.BaseModel"><em>BaseModel</em></a><em>]</em>) – List of BaseModel instances.</p></li>
<li><p><strong>attr</strong> (<em>str</em>) – Attribute name to average (e.g., ‘agent_action_history’).</p></li>
<li><p><strong>inner_mean</strong> (<em>bool</em>) – If True, take mean over
inner array before averaging across models.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average value at each time step.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.clustering_score_over_time">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">clustering_score_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'action'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#clustering_score_over_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.clustering_score_over_time" title="Link to this definition">¶</a></dt>
<dd><p>Compute a clustering score at each time step for a 1D action vector per step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The model instance.</p></li>
<li><p><strong>attribute</strong> (<em>str</em>) – Attribute name for the per-timestep 1D agent data.</p></li>
<li><p><strong>width</strong> (<em>int</em>) – Grid width.</p></li>
<li><p><strong>height</strong> (<em>int</em>) – Grid height.</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – Neighborhood radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Clustering scores per time step.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.extract_mean_and_variance">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">extract_mean_and_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#extract_mean_and_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.extract_mean_and_variance" title="Link to this definition">¶</a></dt>
<dd><p>Extract the mean and variance of a specified attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models</strong> (<em>list</em>) – List of BaseModel instances.</p></li>
<li><p><strong>attribute</strong> (<em>str</em>) – The name of the attribute history
to extract (e.g., “agent_action_history”).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(means, variances), where each is a list of values per time step.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.get_dominant_frequency_and_power">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">get_dominant_frequency_and_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#get_dominant_frequency_and_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.get_dominant_frequency_and_power" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the dominant frequency and its power in a time series signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>np.ndarray</em>) – 1D array of time series data.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Time step between samples in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dominant frequency (Hz) and its power.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.local_action_agreement_score">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">local_action_agreement_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flat_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#local_action_agreement_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.local_action_agreement_score" title="Link to this definition">¶</a></dt>
<dd><p>Compute a spatial clustering score based on local action agreement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flat_grid</strong> (<em>np.ndarray</em>) – 1D array of agent actions.</p></li>
<li><p><strong>width</strong> (<em>int</em>) – Width of the agent grid.</p></li>
<li><p><strong>height</strong> (<em>int</em>) – Height of the agent grid.</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – Neighborhood radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Clustering score (0 to 1).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abm_project.batch_run_tools.run_parameter_batch">
<span class="sig-prename descclassname"><span class="pre">abm_project.batch_run_tools.</span></span><span class="sig-name descname"><span class="pre">run_parameter_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#abm_project.oop_model.BaseModel" title="abm_project.oop_model.BaseModel"><span class="pre">BaseModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/abm_project/batch_run_tools.html#run_parameter_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abm_project.batch_run_tools.run_parameter_batch" title="Link to this definition">¶</a></dt>
<dd><p>Run a batch of agent-based model simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_runs</strong> (<em>int</em>) – Number of model runs to execute.</p></li>
<li><p><strong>model_class</strong> (<em>type</em>) – The class of the model to instantiate.</p></li>
<li><p><strong>steps</strong> (<em>int</em>) – Number of simulation steps to run for each model.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to pass to the model constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of model instances after running the simulation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="#abm_project.oop_model.BaseModel" title="abm_project.oop_model.BaseModel">BaseModel</a>]</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ABM Project</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="getting_started.html" title="previous chapter">Getting started</a></li>
      <li>Next: <a href="contributing.html" title="next chapter">Contributing</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Karolina Chlopicka, Victoria Peterson, Shania Sinha, Henry Zwart.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>